/**
 * Autoblogger Theme CSS (Isolated)
 * 
 * All styles are scoped under .autoblogger container
 * Variables are prefixed with --ab- to avoid conflicts with host app
 * 
 * NOTE: We do NOT alias --ab-* to standard names (--background, etc)
 * because that can override host app's Tailwind utilities.
 * Components should use --ab-* variables directly or inherit from host.
 */

/* ============================================
   CSS VARIABLES (scoped to .autoblogger)
   ============================================ */

.autoblogger {
  /* 
   * Light mode variables - define BOTH prefixed (--ab-*) and standard names
   * Standard names override host app's variables within .autoblogger scope
   * This ensures autoblogger's theme is independent of host's theme
   */
  --ab-background: 0 0% 100%;
  --ab-foreground: 240 10% 3.9%;
  --ab-card: 0 0% 100%;
  --ab-card-foreground: 240 10% 3.9%;
  --ab-popover: 0 0% 100%;
  --ab-popover-foreground: 240 10% 3.9%;
  --ab-primary: 240 5.9% 10%;
  --ab-primary-foreground: 0 0% 98%;
  --ab-secondary: 240 4.8% 95.9%;
  --ab-secondary-foreground: 240 5.9% 10%;
  --ab-muted: 240 4.8% 95.9%;
  --ab-muted-foreground: 240 3.8% 46.1%;
  --ab-accent: 240 4.8% 95.9%;
  --ab-accent-foreground: 240 5.9% 10%;
  --ab-destructive: 0 84.2% 60.2%;
  --ab-destructive-foreground: 0 0% 98%;
  --ab-border: 240 5.9% 90%;
  --ab-input: 240 5.9% 90%;
  --ab-ring: 240 10% 3.9%;
  --ab-radius: 0.5rem;

  /* Standard variable names (for Tailwind utilities like bg-background) */
  --background: 0 0% 100%;
  --foreground: 240 10% 3.9%;
  --card: 0 0% 100%;
  --card-foreground: 240 10% 3.9%;
  --popover: 0 0% 100%;
  --popover-foreground: 240 10% 3.9%;
  --primary: 240 5.9% 10%;
  --primary-foreground: 0 0% 98%;
  --secondary: 240 4.8% 95.9%;
  --secondary-foreground: 240 5.9% 10%;
  --muted: 240 4.8% 95.9%;
  --muted-foreground: 240 3.8% 46.1%;
  --accent: 240 4.8% 95.9%;
  --accent-foreground: 240 5.9% 10%;
  --destructive: 0 84.2% 60.2%;
  --destructive-foreground: 0 0% 98%;
  --border: 240 5.9% 90%;
  --input: 240 5.9% 90%;
  --ring: 240 10% 3.9%;
  --radius: 0.5rem;

  /* Semantic tokens for status/state colors */
  --ab-success: 22 163 74;           /* green-600 */
  --ab-success-muted: 34 197 94;     /* green-500 */
  --ab-warning: 217 119 6;           /* amber-600 */
  --ab-warning-subtle: 254 243 199;  /* amber-100 */
  --ab-active: 59 130 246;           /* blue-500 */
  
  /* Neutral grays */
  --ab-neutral: 107 114 128;         /* gray-500 - secondary text */
  --ab-neutral-subtle: 243 244 246;  /* gray-100 - subtle backgrounds */
  --ab-neutral-border: 229 231 235;  /* gray-200 - borders */
  --ab-neutral-strong: 75 85 99;     /* gray-600 - stronger text */
  
  /* Surfaces */
  --ab-surface-input: 255 255 255;   /* white - input backgrounds */
  
  /* Highlights (comments, quotes) */
  --ab-highlight: 254 252 232;       /* yellow-50 */
  --ab-highlight-strong: 254 249 195; /* yellow-100 */
  --ab-highlight-border: 250 204 21; /* yellow-400 */
  
  /* Placeholder text */
  --ab-placeholder: 209 213 219;     /* gray-300 */
}

/* Fixed background layer to prevent color bleed on mobile bounce/overscroll
   Uses a pseudo-element instead of modifying body to avoid leaking styles to host app */
.autoblogger::before {
  content: '';
  position: fixed;
  inset: 0;
  background-color: hsl(var(--background));
  z-index: -1;
  pointer-events: none;
}

/* Dark mode variables (scoped to .autoblogger.dark) */
.autoblogger.dark {
  --ab-background: 240 10% 3.9%;
  --ab-foreground: 0 0% 98%;
  --ab-card: 240 10% 3.9%;
  --ab-card-foreground: 0 0% 98%;
  --ab-popover: 240 10% 3.9%;
  --ab-popover-foreground: 0 0% 98%;
  --ab-primary: 0 0% 98%;
  --ab-primary-foreground: 240 5.9% 10%;
  --ab-secondary: 240 3.7% 15.9%;
  --ab-secondary-foreground: 0 0% 98%;
  --ab-muted: 240 3.7% 15.9%;
  --ab-muted-foreground: 240 5% 64.9%;
  --ab-accent: 240 3.7% 15.9%;
  --ab-accent-foreground: 0 0% 98%;
  --ab-destructive: 0 62.8% 30.6%;
  --ab-destructive-foreground: 0 0% 98%;
  --ab-border: 240 3.7% 15.9%;
  --ab-input: 240 3.7% 15.9%;
  --ab-ring: 240 4.9% 83.9%;

  /* Standard variable names for dark mode */
  --background: 240 10% 3.9%;
  --foreground: 0 0% 98%;
  --card: 240 10% 3.9%;
  --card-foreground: 0 0% 98%;
  --popover: 240 10% 3.9%;
  --popover-foreground: 0 0% 98%;
  --primary: 0 0% 98%;
  --primary-foreground: 240 5.9% 10%;
  --secondary: 240 3.7% 15.9%;
  --secondary-foreground: 0 0% 98%;
  --muted: 240 3.7% 15.9%;
  --muted-foreground: 240 5% 64.9%;
  --accent: 240 3.7% 15.9%;
  --accent-foreground: 0 0% 98%;
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 0 0% 98%;
  --border: 240 3.7% 15.9%;
  --input: 240 3.7% 15.9%;
  --ring: 240 4.9% 83.9%;

  /* Semantic tokens for status/state colors */
  --ab-success: 74 222 128;          /* green-400 */
  --ab-success-muted: 34 197 94;     /* green-500 */
  --ab-warning: 251 191 36;          /* amber-400 */
  --ab-warning-subtle: 120 53 15;    /* amber-900/30 approx */
  --ab-active: 96 165 250;           /* blue-400 */
  
  /* Neutral grays */
  --ab-neutral: 156 163 175;         /* gray-400 */
  --ab-neutral-subtle: 31 41 55;     /* gray-800 */
  --ab-neutral-border: 55 65 81;     /* gray-700 */
  --ab-neutral-strong: 156 163 175;  /* gray-400 */
  
  /* Surfaces */
  --ab-surface-input: 17 24 39;      /* gray-900 */
  
  /* Highlights (comments, quotes) */
  --ab-highlight: 113 63 18;         /* yellow-900/20 approx */
  --ab-highlight-strong: 113 63 18;  /* yellow-900/30 approx */
  --ab-highlight-border: 202 138 4;  /* yellow-600 */
  
  /* Placeholder text */
  --ab-placeholder: 55 65 81;        /* gray-700 */
}

/* ============================================
   CSS RESET (scoped to .autoblogger)
   
   HYBRID APPROACH:
   - High specificity (.autoblogger.autoblogger) for margin/padding/list-style
     → Blocks host's global "p { margin: 1rem }" etc.
   - Zero specificity (:where()) for font-weight/color/font-size
     → Allows Tailwind utilities like font-bold, text-red-500 to work
   ============================================ */

/* High specificity: box-sizing (safe, doesn't conflict with utilities) */
.autoblogger.autoblogger *,
.autoblogger.autoblogger *::before,
.autoblogger.autoblogger *::after {
  box-sizing: border-box;
}

/* Zero specificity: inheritable properties that Tailwind controls */
.autoblogger :where(*, *::before, *::after) {
  font-family: inherit;
  color: inherit;
}

/* High specificity: block host's form element margins only */
.autoblogger.autoblogger input,
.autoblogger.autoblogger textarea,
.autoblogger.autoblogger select,
.autoblogger.autoblogger button {
  margin: 0;
}

/* Zero specificity: form element font inheritance (Tailwind can override) */
.autoblogger :where(input, textarea, select, button) {
  font-family: inherit;
  font-size: inherit;
  color: inherit;
}

/* Prevent iOS zoom on input focus - ensure minimum 16px font size */
@supports (-webkit-touch-callout: none) {
  .autoblogger :where(input, textarea, select) {
    font-size: max(16px, 1em);
  }
}

/* High specificity: block host's img/svg sizing */
.autoblogger.autoblogger img,
.autoblogger.autoblogger svg,
.autoblogger.autoblogger video {
  display: block;
  max-width: 100%;
}

/* Zero specificity: link styling (Tailwind can override) */
.autoblogger :where(a) {
  color: inherit;
  text-decoration: inherit;
}

/* High specificity: block host's list margins/padding */
.autoblogger.autoblogger ul,
.autoblogger.autoblogger ol {
  list-style: none;
  margin: 0;
  padding: 0;
}

/* High specificity: block host's heading/paragraph margins */
.autoblogger.autoblogger h1,
.autoblogger.autoblogger h2,
.autoblogger.autoblogger h3,
.autoblogger.autoblogger h4,
.autoblogger.autoblogger h5,
.autoblogger.autoblogger h6,
.autoblogger.autoblogger p {
  margin: 0;
}

/* Zero specificity: heading/paragraph font properties (Tailwind can override) */
.autoblogger :where(h1, h2, h3, h4, h5, h6, p) {
  font-weight: inherit;
  font-size: inherit;
  color: inherit;
}

/* ============================================
   SCOPED BASE STYLES (only inside .autoblogger)
   Uses autoblogger's own CSS variables for colors
   Completely isolated from host app
   ============================================ */

.autoblogger {
  /* Set explicit styles for the container - prevents inheritance from host */
  background-color: hsl(var(--background));
  color: hsl(var(--foreground));
  /* Use system font stack - explicitly set to prevent inheritance from host */
  font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  font-size: 16px;
  line-height: 1.5;
  font-weight: 400;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Ensure container fills viewport to prevent background bleed */
  min-height: 100vh;
  min-height: 100dvh;
}

/* Theme transition - applied to all elements for smooth dark/light mode switching */
.autoblogger,
.autoblogger *,
.autoblogger *::before,
.autoblogger *::after {
  transition: background-color 150ms ease-in-out, border-color 150ms ease-in-out, color 150ms ease-in-out;
}

.autoblogger a, .autoblogger button {
  touch-action: manipulation;
}

/* ============================================
   DROPDOWN BACKDROP
   Captures clicks outside dropdown to prevent click-through
   ============================================ */

.ab-dropdown-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 79;
}

/* ============================================
   ANIMATIONS
   ============================================ */

@keyframes ab-fadeInUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

.autoblogger .animate-fade-in-up {
  opacity: 0;
  animation: ab-fadeInUp 0.5s ease-out forwards;
}

@media (prefers-reduced-motion: reduce) {
  .autoblogger .animate-fade-in-up {
    animation: none;
    opacity: 1;
  }
}

/* ============================================
   PROSE STYLES (scoped under .autoblogger)
   Uses host app's CSS variables
   ============================================ */

.autoblogger .prose { 
  max-width: none; 
  font-size: 16px;
  line-height: 1.625;
  color: inherit;
}
.autoblogger .prose > *:first-child { margin-top: 0; }
.autoblogger .prose > *:last-child { margin-bottom: 0; }
.autoblogger .prose h1 { font-size: 22px; line-height: 1.3; font-weight: 700; margin-bottom: 1.5rem; }
.autoblogger .prose h2 { font-size: 18px; line-height: 1.4; font-weight: 700; margin-top: 2rem; margin-bottom: 1rem; }
.autoblogger .prose h3 { font-size: 16px; line-height: 1.4; font-weight: 700; margin-top: 1.5rem; margin-bottom: 0.75rem; }
.autoblogger .prose p { margin-bottom: 1rem; line-height: 1.625; }
.autoblogger .prose ul, .autoblogger .prose ol { margin-bottom: 1rem; padding-left: 1.5rem; }
.autoblogger .prose li { margin-bottom: 0.5rem; line-height: 1.625; }
.autoblogger .prose ul li { list-style-type: disc; }
.autoblogger .prose ol li { list-style-type: decimal; }
.autoblogger .prose a { color: #2563eb; text-decoration: underline; }
.autoblogger.dark .prose a { color: #60a5fa; }
.autoblogger .prose strong { font-weight: 600; }
.autoblogger .prose em { font-style: italic; }
.autoblogger .prose code { background-color: hsl(var(--muted)); padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.875em; }
.autoblogger .prose pre { background-color: hsl(var(--muted)); padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 1rem; }
.autoblogger .prose pre code { background-color: transparent; padding: 0; font-size: 0.875rem; }
.autoblogger .prose blockquote { border-left: 4px solid hsl(var(--border)); padding-left: 1rem; font-style: italic; margin: 1rem 0; color: hsl(var(--muted-foreground)); }
.autoblogger .prose img { border-radius: 0.5rem; margin: 1rem 0; max-width: 100%; height: auto; }
.autoblogger .prose hr { margin: 2rem 0; border: none; border-top: 1px solid hsl(var(--border)); }
.autoblogger .prose table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
.autoblogger .prose th, .autoblogger .prose td { border: 1px solid hsl(var(--border)); padding: 0.5rem 0.75rem; text-align: left; }
.autoblogger .prose th { font-weight: 600; background-color: hsl(var(--muted)); }

/* ============================================
   PROSE STYLES (standalone - for public pages)
   Uses --ab-* variables with fallbacks
   ============================================ */

.ab-prose { 
  max-width: none; 
  font-size: 16px;
  line-height: 1.625;
}
.ab-prose > *:first-child { margin-top: 0; }
.ab-prose > *:last-child { margin-bottom: 0; }
.ab-prose h1 { font-size: 22px; line-height: 1.3; font-weight: 700; margin-bottom: 1.5rem; }
.ab-prose h2 { font-size: 18px; line-height: 1.4; font-weight: 700; margin-top: 2rem; margin-bottom: 1rem; }
.ab-prose h3 { font-size: 16px; line-height: 1.4; font-weight: 700; margin-top: 1.5rem; margin-bottom: 0.75rem; }
.ab-prose p { margin-bottom: 1rem; line-height: 1.625; }
.ab-prose ul, .ab-prose ol { margin-bottom: 1rem; padding-left: 1.5rem; }
.ab-prose li { margin-bottom: 0.5rem; line-height: 1.625; }
.ab-prose ul li { list-style-type: disc; }
.ab-prose ol li { list-style-type: decimal; }
.ab-prose a { color: #2563eb; text-decoration: underline; }
:is(.dark, .autoblogger.dark) .ab-prose a { color: #60a5fa; }
.ab-prose strong { font-weight: 600; }
.ab-prose em { font-style: italic; }
.ab-prose code { background-color: hsl(var(--ab-muted, var(--muted, 240 4.8% 95.9%))); padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.875em; }
.ab-prose pre { background-color: hsl(var(--ab-muted, var(--muted, 240 4.8% 95.9%))); padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 1rem; }
.ab-prose pre code { background-color: transparent; padding: 0; font-size: 0.875rem; }
.ab-prose blockquote { border-left: 4px solid hsl(var(--ab-border, var(--border, 240 5.9% 90%))); padding-left: 1rem; font-style: italic; margin: 1rem 0; color: hsl(var(--ab-muted-foreground, var(--muted-foreground, 240 3.8% 46.1%))); }
.ab-prose img { border-radius: 0.5rem; margin: 1rem 0; max-width: 100%; height: auto; }
.ab-prose hr { margin: 2rem 0; border: none; border-top: 1px solid hsl(var(--ab-border, var(--border, 240 5.9% 90%))); }
.ab-prose table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
.ab-prose th, .ab-prose td { border: 1px solid hsl(var(--ab-border, var(--border, 240 5.9% 90%))); padding: 0.5rem 0.75rem; text-align: left; }
.ab-prose th { font-weight: 600; background-color: hsl(var(--ab-muted, var(--muted, 240 4.8% 95.9%))); }
:is(.dark, .autoblogger.dark) .ab-prose code { background-color: hsl(var(--ab-muted, var(--muted, 240 3.7% 15.9%))); }
:is(.dark, .autoblogger.dark) .ab-prose pre { background-color: hsl(var(--ab-muted, var(--muted, 240 3.7% 15.9%))); }
:is(.dark, .autoblogger.dark) .ab-prose blockquote { border-left-color: hsl(var(--ab-border, var(--border, 240 3.7% 15.9%))); color: hsl(var(--ab-muted-foreground, var(--muted-foreground, 240 5% 64.9%))); }
:is(.dark, .autoblogger.dark) .ab-prose hr { border-top-color: hsl(var(--ab-border, var(--border, 240 3.7% 15.9%))); }
:is(.dark, .autoblogger.dark) .ab-prose th, :is(.dark, .autoblogger.dark) .ab-prose td { border-color: hsl(var(--ab-border, var(--border, 240 3.7% 15.9%))); }
:is(.dark, .autoblogger.dark) .ab-prose th { background-color: hsl(var(--ab-muted, var(--muted, 240 3.7% 15.9%))); }

/* ============================================
   TIPTAP EDITOR STYLES (scoped)
   ============================================ */

.autoblogger .ProseMirror:focus { outline: none; }

/* Prevent auto-scrolling on mobile when editing */
.autoblogger .ProseMirror {
  /* Prevent browser from auto-scrolling to focused elements */
  scroll-margin-top: 120px;
  scroll-margin-bottom: 60px;
  /* Touch optimization */
  touch-action: pan-y;
  -webkit-tap-highlight-color: transparent;
  /* Prevent layout shifts that could cause scrolling */
  overflow-anchor: none;
}
.autoblogger .ProseMirror p.is-editor-empty:first-child::before {
  content: attr(data-placeholder);
  color: #d1d5db;
  pointer-events: none;
  float: left;
  height: 0;
}
.autoblogger.dark .ProseMirror p.is-editor-empty:first-child::before { color: #374151; }
.autoblogger .ProseMirror h1 { font-size: 22px; line-height: 1.3; }
.autoblogger .ProseMirror h2 { font-size: 18px; line-height: 1.4; }
.autoblogger .ProseMirror h3 { font-size: 16px; line-height: 1.4; }
